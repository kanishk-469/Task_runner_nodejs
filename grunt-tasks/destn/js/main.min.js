let express=require("express"),http=require("http"),Server=require("socket.io").Server,mongoose=require("mongoose"),taskSchema=new mongoose.Schema({text:{type:String,required:!0},createdAt:{type:Date,default:Date.now}}),Task=mongoose.model("Task",taskSchema),app=express(),server=http.createServer(app),io=new Server(server);mongoose.connect("mongodb://localhost:27017/todoApp",{useNewUrlParser:!0,useUnifiedTopology:!0}),io.on("connection",e=>{console.log("New user connected!"),e.on("addTask",async e=>{e=new Task({text:e});await e.save(),io.emit("taskAdded",e)}),e.on("deleteTask",async e=>{await Task.findByIdAndDelete(e),io.emit("taskDeleted",e)}),e.on("updateTask",async({taskId:e,newText:t})=>{await Task.findByIdAndUpdate(e,{text:t}),io.emit("taskUpdated",{taskId:e,newText:t})})}),server.listen(3e3,()=>console.log("ğŸš€ Server running on port 3000"));